////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var config = require("config");
var express = require('express');
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var viewController = require('../controllers/pickups/pickupsViewController');
var apiController = require('../controllers/pickups/pickupsApiController');
var recycleUploader = require('../controllers/_modules/recycleUploader');
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var router = express.Router();

router.use(function checkAuth( req, res, next ){
    if (!req.user) { res.redirect('/login'); return } // セッション確認
    next();
})

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// View
router.get('/', viewController.index); // 一覧表示

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// API

router.post("/", apiController.add ); // ピックアップ枠の追加
router.put('/:id', apiController.edit ); // ピックアップ枠の編集
router.delete('/:id', apiController.remove ); // ピックアップ枠の削除

router.put("/position/save", apiController.savePosition ); // 並び順保存

// アップローダー設定

// 通常バナー画像用
router.get('/images/banner', recycleUploader.getFileList );
router.post('/images/banner', recycleUploader.save );
router.delete('/images/banner/:fileName', recycleUploader.remove );

// ネイティブアド背景画像用
router.get('/images/nativeAdBackground', recycleUploader.getFileList );
router.post('/images/nativeAdBackground', recycleUploader.save );
router.delete('/images/nativeAdBackground/:fileName', recycleUploader.remove );

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

module.exports = router;
